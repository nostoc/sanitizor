import ballerina/io;
import ballerinax/smartsheet;

configurable string accessToken = ?;

public function main() returns error? {
    smartsheet:Client smartsheetClient = check new ({
        auth: {
            token: accessToken
        }
    });

    string csvContent = "Task,Status,Due Date\nProject Setup,Not Started,2024-01-15\nRequirements Gathering,Not Started,2024-01-22\nDesign Phase,Not Started,2024-02-05";
    byte[] csvData = csvContent.toBytes();

    string workspaceId = "123456789";

    smartsheet:ImportSheetIntoWorkspaceHeaders headers = {
        authorization: "Bearer " + accessToken,
        contentDisposition: "attachment; filename=\"project_tasks.csv\"",
        contentType: "text/csv"
    };

    smartsheet:ImportSheetIntoWorkspaceQueries queries = {
        sheetName: "Project Tasks and Milestones",
        headerRowIndex: 0,
        primaryColumnIndex: 0
    };

    smartsheet:WebhookListResponse response = check smartsheetClient->/workspaces/[workspaceId]/sheets/'import.post(headers, csvData, ...queries);

    io:println("Workspace setup completed successfully!");
    io:println("Response: ", response);

    if response.result is smartsheet:SheetImported {
        smartsheet:SheetImported sheet = <smartsheet:SheetImported>response.result;
        io:println("Sheet created with ID: ", sheet.id);
        io:println("Sheet name: ", sheet.name);
        io:println("Sheet permalink: ", sheet.permalink);
        io:println("Access level: ", sheet.accessLevel);
    }

    io:println("Project workspace is now ready for team collaboration!");
}